const initialTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone,initialIsEurope=initialTimezone.includes("Europe");let userRegion={continent:initialIsEurope?"EU":"AM",country:initialIsEurope?"Europe":"Americas",countryCode:initialIsEurope?"EU":"US",currency:initialIsEurope?"EUR":"USD",currencySymbol:initialIsEurope?"‚Ç¨":"$",isEurope:initialIsEurope,timezone:initialTimezone};console.log("Initial region set:",userRegion);const EUROPEAN_COUNTRIES=["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","GB","NO","CH","IS","LI","MC","SM","VA","AD","AL","BA","BY","MD","MK","RS","ME","UA"];async function detectUserRegion(){try{const e=Intl.DateTimeFormat().resolvedOptions().timeZone,o=e.includes("Europe");console.log("üåç Detecting region..."),console.log("üìç Current timezone:",e),console.log("üá™üá∫ Is Europe timezone?",o);const n=localStorage.getItem("userRegion");if(n){const i=JSON.parse(n);if(console.log("üíæ Found cached region:",i),!0===i.manual)return i.timezone=e,userRegion=i,updateRegionIndicator(),console.log("‚úÖ Using manual region override:",userRegion),userRegion;if(i.isEurope===o)return i.timezone=e,userRegion=i,updateRegionIndicator(),console.log("‚úÖ Using validated cache:",userRegion),userRegion;console.log("‚ö†Ô∏è Cache mismatch! Timezone says Europe:",o,"but cache says:",i.isEurope),console.log("üîÑ Clearing invalid cache and re-detecting..."),localStorage.removeItem("userRegion")}try{const o=await fetch("https://ipapi.co/json/",{timeout:3e3}),n=await o.json();if(n&&n.country_code){const o=n.country_code,i=EUROPEAN_COUNTRIES.includes(o);return userRegion={continent:n.continent_code||"unknown",country:n.country_name||(i?"Europe":"Unknown"),countryCode:o,currency:i?"EUR":"USD",currencySymbol:i?"‚Ç¨":"$",isEurope:i,timezone:n.timezone||e},localStorage.setItem("userRegion",JSON.stringify(userRegion)),updateRegionIndicator(),console.log("‚úÖ Region detected via IP:",userRegion),userRegion}}catch(e){console.log("‚ö†Ô∏è IP API failed, using timezone detection:",e.message)}return userRegion={continent:o?"EU":"AM",country:o?"Europe":"Americas",countryCode:o?"EU":"US",currency:o?"EUR":"USD",currencySymbol:o?"‚Ç¨":"$",isEurope:o,timezone:e},localStorage.setItem("userRegion",JSON.stringify(userRegion)),updateRegionIndicator(),console.log("‚úÖ Region detected via timezone:",userRegion),userRegion}catch(e){console.error("‚ùå Error detecting region:",e);const o=Intl.DateTimeFormat().resolvedOptions().timeZone,n=o.includes("Europe");return userRegion={continent:n?"EU":"AM",country:n?"Europe":"Americas",countryCode:n?"EU":"US",currency:n?"EUR":"USD",currencySymbol:n?"‚Ç¨":"$",isEurope:n,timezone:o},localStorage.setItem("userRegion",JSON.stringify(userRegion)),updateRegionIndicator(),console.log("‚úÖ Region defaulted via timezone fallback:",userRegion),userRegion}}function updateRegionIndicator(){const e=document.getElementById("regionIndicator");if(e){const o=userRegion.isEurope?"üá™üá∫":"üåé";e.innerHTML=`${o} ${userRegion.country||"Unknown"} | ${userRegion.currencySymbol}`}}function formatPrice(e){if(userRegion.isEurope){return`‚Ç¨${(.92*e).toFixed(2)}`}return`$${e.toFixed(2)}`}function getCurrency(){return userRegion.currency}function getCurrencySymbol(){return userRegion.currencySymbol}function getRegion(){return userRegion}document.addEventListener("DOMContentLoaded",function(){detectUserRegion()}),window.userRegion=userRegion,window.detectUserRegion=detectUserRegion,window.formatPrice=formatPrice,window.getCurrency=getCurrency,window.getCurrencySymbol=getCurrencySymbol,window.getRegion=getRegion;